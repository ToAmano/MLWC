<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting-started tutorial No. 1: Liquid methanol &mdash; dieltools  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting-started tutorial No. 2: Isolated methanol" href="getting-started_2.html" />
    <link rel="prev" title="Installation" href="install/installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            dieltools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install/installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting-started tutorial No. 1: Liquid methanol</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#required-data-for-calculations">Required data for calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#xyz-format-atomic-structures-for-training-data">xyz format atomic structures for training data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mol-file-for-bond-information">Mol file for bond information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#model-training">Model training</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prepare-input-parameters">Prepare input parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#train-a-model">Train a model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-a-model">Test a model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#calculate-dipoles-along-md-trajectories">Calculate dipoles along MD trajectories</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting-started_2.html">Getting-started tutorial No. 2: Isolated methanol</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started_3.html">Getting-started tutorial No. 3: Liquid water : dielectric spectra</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dieltools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting-started tutorial No. 1: Liquid methanol</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/getting-started_1.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started-tutorial-no-1-liquid-methanol">
<h1>Getting-started tutorial No. 1: Liquid methanol<a class="headerlink" href="#getting-started-tutorial-no-1-liquid-methanol" title="Link to this heading"></a></h1>
<p>In this tutorial, we train ML dipole models of liquid methanol.</p>
<section id="required-data-for-calculations">
<h2>Required data for calculations<a class="headerlink" href="#required-data-for-calculations" title="Link to this heading"></a></h2>
<p>To train ML models for dipole moment, we only need two files:</p>
<ul class="simple">
<li><p>atomic coordinates with Wannier centers</p></li>
<li><p>molecular structure (chemical bond information)</p></li>
</ul>
<p>The first file is assumed to be the <code class="docutils literal notranslate"><span class="pre">extended</span> <span class="pre">xyz</span></code> format via <code class="docutils literal notranslate"><span class="pre">ase</span></code> package, which also contains the supercell information. The second file should be a standard <code class="docutils literal notranslate"><span class="pre">mol</span></code> file to be processed using <code class="docutils literal notranslate"><span class="pre">rdkit</span></code>. We prepared a simple example using the isolated methanol system for this tutorial. Necessary files are included in this repository. Let’s go to <cite>tutorial/tutorial1/</cite>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">$cd</span><span class="w"> </span>examples/tutorial/tutorial1/
<span class="nv">$tree</span>
├──<span class="w"> </span>IONS+CENTERS+cell_sorted_merge.xyz<span class="w"> </span>-&gt;<span class="w"> </span>../../CPtrain/cptrain_train/IONS+CENTERS+cell_sorted_merge.xyz
├──<span class="w"> </span>config.yaml
├──<span class="w"> </span>methanol.mol
└──<span class="w"> </span>train.yaml
</pre></div>
</div>
<section id="xyz-format-atomic-structures-for-training-data">
<h3>xyz format atomic structures for training data<a class="headerlink" href="#xyz-format-atomic-structures-for-training-data" title="Link to this heading"></a></h3>
<p>The order of atoms should satisfy three things</p>
<ul class="simple">
<li><p>The atomic order must be molecule-by-molecule.</p></li>
<li><p>The atomic order in each molecule should be the same as the <code class="docutils literal notranslate"><span class="pre">*.mol</span></code> file.</p></li>
<li><p>The WCs should come last.</p></li>
</ul>
<p>If you see the first 14 lines of <code class="docutils literal notranslate"><span class="pre">methanol.xyz</span></code>, you can find C, four H,O and eight X, where <cite>X</cite> means the Wannier centers (WC). There are the atoms and WCs included in a single MD step.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>methanol.xyz
</pre></div>
</div>
<p>They are visualized using <cite>nglview</cite> package via jupyter notebook as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">nglview</span>
<span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="n">ase</span>
        <span class="kn">import</span> <span class="nn">nglview</span> <span class="k">as</span> <span class="nn">nv</span>
        <span class="kn">import</span> <span class="nn">ase.io</span>

<span class="c1"># read all the trajectory.</span>
<span class="c1"># If you want to extract a single step instead, try like ase.io.read(&quot;filename&quot;, index=1)</span>
        <span class="n">aseatoms</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;mol_wan.xyz&quot;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="c1"># This if for list of ase.atoms. If you want to see single ase.atom, use nv.show_ase.</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">nv</span><span class="o">.</span><span class="n">show_asetraj</span><span class="p">(</span><span class="n">aseatoms</span><span class="p">,</span><span class="n">gui</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">clear_representations</span><span class="p">()</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">label_type</span><span class="o">=</span><span class="s2">&quot;atom&quot;</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s2">&quot;_He&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.004</span><span class="p">,</span><span class="n">aspectRatio</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s2">&quot;_Ne&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.004</span><span class="p">,</span><span class="n">aspectRatio</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s2">&quot;_Ar&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.004</span><span class="p">,</span><span class="n">aspectRatio</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="c1">#w.add_ball_and_stick(&quot;_Li&quot;,color=&quot;cyan&quot;,radius=0.1)</span>
        <span class="c1">#w.add_ball_and_stick(&quot;_Be&quot;,color=&quot;blue&quot;,radius=0.1)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s2">&quot;_H&quot;</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s2">&quot;_C&quot;</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s2">&quot;_O&quot;</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">add_ball_and_stick</span><span class="p">(</span><span class="s2">&quot;_N&quot;</span><span class="p">)</span>

        <span class="n">w</span><span class="o">.</span><span class="n">add_unitcell</span><span class="p">()</span>
        <span class="n">w</span><span class="o">.</span><span class="n">update_unitcell</span><span class="p">()</span>
        <span class="n">w</span>
</pre></div>
</div>
<p>We have <code class="docutils literal notranslate"><span class="pre">10000</span></code> MD steps in the file, which will be used for both training and validation data for ML.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># see how many steps in the aseatoms</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aseatoms</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="mol-file-for-bond-information">
<h3>Mol file for bond information<a class="headerlink" href="#mol-file-for-bond-information" title="Link to this heading"></a></h3>
<p>Next, we dig into the <cite>*.mol</cite> file, which contains molecular structures including atomic and bonding information.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>methanol.mol
<span class="m">6</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0999</span><span class="w"> </span>V2000
<span class="w">    </span><span class="m">0</span>.9400<span class="w">    </span><span class="m">0</span>.0200<span class="w">   </span>-0.0900<span class="w"> </span>C<span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="w">    </span><span class="m">0</span>.4700<span class="w">    </span><span class="m">0</span>.2700<span class="w">   </span>-1.4000<span class="w"> </span>O<span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="w">    </span><span class="m">0</span>.5800<span class="w">   </span>-0.9500<span class="w">    </span><span class="m">0</span>.2400<span class="w"> </span>H<span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="w">    </span><span class="m">0</span>.5700<span class="w">    </span><span class="m">0</span>.8000<span class="w">    </span><span class="m">0</span>.5800<span class="w"> </span>H<span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="w">    </span><span class="m">2</span>.0400<span class="w">    </span><span class="m">0</span>.0200<span class="w">   </span>-0.0900<span class="w"> </span>H<span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="w">    </span><span class="m">0</span>.8100<span class="w">    </span><span class="m">1</span>.1400<span class="w">   </span>-1.6700<span class="w"> </span>H<span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">1</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">1</span><span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">1</span><span class="w">  </span><span class="m">4</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="m">6</span><span class="w">  </span><span class="m">2</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
M<span class="w">  </span>END
</pre></div>
</div>
<p>The second to seventh lines are called atom block, which contain atomic coordinates and species in a single molecule. We only use atomic species for training. The following data is called atom block, representing bonding information.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
</pre></div>
</div>
<p>For example, the above line means the first and fifth atom (C and H) have a chemical bond. In other words, the atoms with first two numbers have a chemical bond. The <code class="docutils literal notranslate"><span class="pre">*.mol</span></code> format is a standard format for molecular structures, and you can easily find information on it.</p>
</section>
</section>
<section id="model-training">
<h2>Model training<a class="headerlink" href="#model-training" title="Link to this heading"></a></h2>
<section id="prepare-input-parameters">
<h3>Prepare input parameters<a class="headerlink" href="#prepare-input-parameters" title="Link to this heading"></a></h3>
<p>To train models, we implemented <code class="docutils literal notranslate"><span class="pre">CPtrain.py</span></code> command written in python. The command requires a <code class="docutils literal notranslate"><span class="pre">yaml</span></code> format file to specify parameters. Here is an example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">model</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modelname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span><span class="w">  </span><span class="c1"># specify name</span>
<span class="w">    </span><span class="nt">nfeature</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">288</span><span class="w">   </span><span class="c1"># length of descriptor</span>
<span class="w">    </span><span class="nt">M</span><span class="p">:</span><span class="w">         </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">    </span><span class="c1"># M  (embedding matrix size)</span>
<span class="w">    </span><span class="nt">Mb</span><span class="p">:</span><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">6</span><span class="w">     </span><span class="c1"># Mb (embedding matrix size, smaller than M)</span>

<span class="nt">learning_rate</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fix</span>

<span class="nt">loss</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mse</span><span class="w">        </span><span class="c1"># mean square error</span>

<span class="nt">data</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xyz</span><span class="w">        </span><span class="c1"># or xyz</span>
<span class="w">    </span><span class="nt">file</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;IONS+CENTERS+cell_sorted_merge.xyz&quot;</span>
<span class="w">    </span><span class="nt">itp_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">methanol.mol</span>
<span class="w">    </span><span class="nt">bondtype</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ch</span>

<span class="nt">training</span><span class="p">:</span>
<span class="w">    </span><span class="nt">device</span><span class="p">:</span><span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">cpu</span><span class="w"> </span><span class="c1"># Torchのdevice</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span><span class="w">  </span><span class="c1"># batch size for training</span>
<span class="w">    </span><span class="nt">validation_batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span><span class="w"> </span><span class="c1"># batch size for validation</span>
<span class="w">    </span><span class="nt">max_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="w">    </span><span class="nt">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1e-2</span><span class="w"> </span><span class="c1"># starting learning rate</span>
<span class="w">    </span><span class="nt">n_train</span><span class="p">:</span><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">900</span><span class="w">    </span><span class="c1"># the number of training data</span>
<span class="w">    </span><span class="nt">n_val</span><span class="p">:</span><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w">    </span><span class="c1"># the number of validation data</span>
<span class="w">    </span><span class="nt">modeldir</span><span class="p">:</span><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">model_test</span><span class="w"> </span><span class="c1"># directory to save models</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">    </span><span class="c1"># If restart training</span>
</pre></div>
</div>
<p>Parameters written above are basically necessary values (not optional). The input file consists of four parts:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>part name</p></th>
<th class="head"><p>explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>model</p></td>
<td><p>ML model parameters</p></td>
</tr>
<tr class="row-odd"><td><p>learning_rate</p></td>
<td><p>learning rate</p></td>
</tr>
<tr class="row-even"><td><p>loss</p></td>
<td><p>loss function</p></td>
</tr>
<tr class="row-odd"><td><p>data</p></td>
<td><p>training data</p></td>
</tr>
<tr class="row-even"><td><p>training</p></td>
<td><p>training parameters</p></td>
</tr>
</tbody>
</table>
<p>As Basic explanations are given above, we only add some important notes.</p>
<ul>
<li><p>model</p>
<blockquote>
<div><ul class="simple">
<li><p>Model parameters (<code class="docutils literal notranslate"><span class="pre">nfeature</span></code>, <code class="docutils literal notranslate"><span class="pre">M</span></code>, <code class="docutils literal notranslate"><span class="pre">Mb</span></code>) given above are basically enough for simple gas/liquid molecules. Although the detailed meanings of the parameters will be given later, we emphasize that <code class="docutils literal notranslate"><span class="pre">Mb</span></code> should be smaller than <code class="docutils literal notranslate"><span class="pre">M</span></code> by definition, and that <cite>nfeature</cite> should be a multiple of <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modelname</span></code> is just used for file names, so you can use any word as you like.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>learning_rate</p>
<blockquote>
<div><ul class="simple">
<li><p>Currently, we only support fixed learning rate.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>loss</p>
<blockquote>
<div><ul class="simple">
<li><p>Currently, We only support Mean Squared Error (MSE) as a loss function.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>data</p>
<blockquote>
<div><ul class="simple">
<li><p>Training data should be <code class="docutils literal notranslate"><span class="pre">descriptor</span></code> or <code class="docutils literal notranslate"><span class="pre">xyz</span></code>. In this tutorial, we use <code class="docutils literal notranslate"><span class="pre">xyz</span></code> type.</p></li>
<li><p>If training data type is <code class="docutils literal notranslate"><span class="pre">descriptor</span></code>, the descriptor file name should be <code class="code docutils literal notranslate"><span class="pre">*_descs.npy</span></code>, and the true file name should be <code class="code docutils literal notranslate"><span class="pre">*_true.npy</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bondtype</span></code> defines which bond to be trained. The value is one of <code class="docutils literal notranslate"><span class="pre">CH</span></code>, <code class="docutils literal notranslate"><span class="pre">CO</span></code>, <code class="docutils literal notranslate"><span class="pre">OH</span></code>, <code class="docutils literal notranslate"><span class="pre">CC</span></code>, or <code class="docutils literal notranslate"><span class="pre">O</span></code>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>training</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">device</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">pytorch</span></code>’s device for model training. You can use <cite>cpu</cite>, <cite>cuda</cite>, or <cite>mps</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modeldir</span></code> specifies the directory to which model files will be saved.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="train-a-model">
<h3>Train a model<a class="headerlink" href="#train-a-model" title="Link to this heading"></a></h3>
<p>After the training script is prepared, we can start the training by simply running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CPtrain.py<span class="w"> </span>train<span class="w"> </span>-i<span class="w"> </span>input.yaml
</pre></div>
</div>
<p>The code generates <code class="docutils literal notranslate"><span class="pre">stdout</span></code> like</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>your<span class="w"> </span>python<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span>...<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">11</span>

*****************************************************************
<span class="w">                    </span>CPtrain.py
<span class="w">                    </span>Version.<span class="w"> </span><span class="m">0</span>.0.1
*****************************************************************

<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:32,907<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>Start<span class="w"> </span>logging
<span class="o">{</span><span class="s1">&#39;model&#39;</span>:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;modelname&#39;</span>:<span class="w"> </span><span class="s1">&#39;test&#39;</span>,<span class="w"> </span><span class="s1">&#39;nfeature&#39;</span>:<span class="w"> </span><span class="m">288</span>,<span class="w"> </span><span class="s1">&#39;M&#39;</span>:<span class="w"> </span><span class="m">20</span>,<span class="w"> </span><span class="s1">&#39;Mb&#39;</span>:<span class="w"> </span><span class="m">6</span><span class="o">}</span>,<span class="w"> </span><span class="s1">&#39;learning_rate&#39;</span>:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;type&#39;</span>:<span class="w"> </span><span class="s1">&#39;fix&#39;</span><span class="o">}</span>,<span class="w"> </span><span class="s1">&#39;loss&#39;</span>:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;type&#39;</span>:<span class="w"> </span><span class="s1">&#39;mse&#39;</span><span class="o">}</span>,<span class="w"> </span><span class="s1">&#39;data&#39;</span>:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;type&#39;</span>:<span class="w"> </span><span class="s1">&#39;xyz&#39;</span>,<span class="w"> </span><span class="s1">&#39;file&#39;</span>:<span class="w"> </span><span class="o">[</span><span class="s1">&#39;IONS+CENTERS+cell_sorted_merge.xyz&#39;</span><span class="o">]</span>,<span class="w"> </span><span class="s1">&#39;itp_file&#39;</span>:<span class="w"> </span><span class="s1">&#39;methanol.mol&#39;</span><span class="o">}</span>,<span class="w"> </span><span class="s1">&#39;training&#39;</span>:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;device&#39;</span>:<span class="w"> </span><span class="s1">&#39;cpu&#39;</span>,<span class="w"> </span><span class="s1">&#39;batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;validation_batch_size&#39;</span>:<span class="w"> </span><span class="m">32</span>,<span class="w"> </span><span class="s1">&#39;max_epochs&#39;</span>:<span class="w"> </span><span class="m">40</span>,<span class="w"> </span><span class="s1">&#39;learning_rate&#39;</span>:<span class="w"> </span><span class="s1">&#39;1e-2&#39;</span>,<span class="w"> </span><span class="s1">&#39;n_train&#39;</span>:<span class="w"> </span><span class="m">900</span>,<span class="w"> </span><span class="s1">&#39;n_val&#39;</span>:<span class="w"> </span><span class="m">100</span>,<span class="w"> </span><span class="s1">&#39;modeldir&#39;</span>:<span class="w"> </span><span class="s1">&#39;model_test&#39;</span>,<span class="w"> </span><span class="s1">&#39;restart&#39;</span>:<span class="w"> </span>False<span class="o">}}</span>
model<span class="w"> </span>NET<span class="w"> </span>::<span class="w"> </span>nfeatures<span class="w"> </span>::<span class="w">  </span><span class="m">288</span>
nfeatures_enet<span class="w"> </span>::<span class="w"> </span><span class="m">72</span>
nfeatures_fnet<span class="w"> </span>::<span class="w"> </span><span class="nv">120</span>
<span class="o">=================================================================</span>
Layer<span class="w"> </span><span class="o">(</span>type:depth-idx<span class="o">)</span><span class="w">                   </span>Param<span class="w"> </span><span class="c1">#</span>
<span class="o">=================================================================</span>
NET_withoutBN<span class="w">                            </span>--
├─Linear:<span class="w"> </span><span class="m">1</span>-1<span class="w">                            </span><span class="m">3</span>,650
├─Linear:<span class="w"> </span><span class="m">1</span>-2<span class="w">                            </span><span class="m">2</span>,550
├─Linear:<span class="w"> </span><span class="m">1</span>-3<span class="w">                            </span><span class="m">73</span>,440
├─Linear:<span class="w"> </span><span class="m">1</span>-4<span class="w">                            </span><span class="m">6</span>,050
├─Linear:<span class="w"> </span><span class="m">1</span>-5<span class="w">                            </span><span class="m">2</span>,550
├─Linear:<span class="w"> </span><span class="m">1</span>-6<span class="w">                            </span><span class="m">1</span>,020
<span class="o">=================================================================</span>
Total<span class="w"> </span>params:<span class="w"> </span><span class="m">89</span>,260
Trainable<span class="w"> </span>params:<span class="w"> </span><span class="m">89</span>,260
Non-trainable<span class="w"> </span>params:<span class="w"> </span><span class="nv">0</span>
<span class="o">=================================================================</span>
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:32,927<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w">  </span>--------------------------------------
data<span class="w"> </span><span class="nb">type</span><span class="w"> </span>::<span class="w"> </span>xyz
-----<span class="w">  </span>ml.read_mol<span class="w"> </span>::<span class="w"> </span>parse<span class="w"> </span>results...<span class="w"> </span>-------
bonds_list<span class="w"> </span>::<span class="w">  </span><span class="o">[[</span><span class="m">0</span>,<span class="w"> </span><span class="m">4</span><span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>,<span class="w"> </span><span class="m">2</span><span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>,<span class="w"> </span><span class="m">3</span><span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">1</span>,<span class="w"> </span><span class="m">0</span><span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">5</span>,<span class="w"> </span><span class="m">1</span><span class="o">]]</span>
counter<span class="w">    </span>::<span class="w">  </span><span class="m">6</span>
atom_list<span class="w">  </span>::<span class="w">  </span><span class="o">[</span><span class="s1">&#39;C&#39;</span>,<span class="w"> </span><span class="s1">&#39;O&#39;</span>,<span class="w"> </span><span class="s1">&#39;H&#39;</span>,<span class="w"> </span><span class="s1">&#39;H&#39;</span>,<span class="w"> </span><span class="s1">&#39;H&#39;</span>,<span class="w"> </span><span class="s1">&#39;H&#39;</span><span class="o">]</span>
-----------------------------------------------
<span class="o">================</span>
CH<span class="w"> </span>bonds...<span class="w">       </span><span class="o">[[</span><span class="m">0</span>,<span class="w"> </span><span class="m">4</span><span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>,<span class="w"> </span><span class="m">2</span><span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>,<span class="w"> </span><span class="m">3</span><span class="o">]]</span>
CO<span class="w"> </span>bonds...<span class="w">       </span><span class="o">[[</span><span class="m">1</span>,<span class="w"> </span><span class="m">0</span><span class="o">]]</span>
OH<span class="w"> </span>bonds...<span class="w">       </span><span class="o">[[</span><span class="m">5</span>,<span class="w"> </span><span class="m">1</span><span class="o">]]</span>
OO<span class="w"> </span>bonds...<span class="w">       </span><span class="o">[]</span>
CC<span class="w"> </span>bonds...<span class="w">       </span><span class="o">[]</span>
CC<span class="w"> </span>ring<span class="w"> </span>bonds...<span class="w">  </span><span class="o">[]</span>


<span class="o">==================</span>
ring_bond_index<span class="w">  </span><span class="o">[]</span>
ch_bond_index<span class="w">    </span><span class="o">[</span><span class="m">0</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span><span class="o">]</span>
oh_bond_index<span class="w">    </span><span class="o">[</span><span class="m">4</span><span class="o">]</span>
co_bond_index<span class="w">    </span><span class="o">[</span><span class="m">3</span><span class="o">]</span>
cc_bond_index<span class="w">    </span><span class="o">[]</span>
<span class="o">================</span>
O<span class="w"> </span>atoms<span class="w"> </span><span class="o">(</span>lonepair<span class="o">)</span>...<span class="w">       </span><span class="o">[</span><span class="m">1</span><span class="o">]</span>
N<span class="w"> </span>atoms<span class="w"> </span><span class="o">(</span>lonepair<span class="o">)</span>...<span class="w">       </span><span class="o">[]</span>
C<span class="w"> </span>atoms<span class="w"> </span>...<span class="w">                 </span><span class="o">[</span><span class="m">0</span><span class="o">]</span>
H<span class="w"> </span>atoms<span class="w"> </span>...<span class="w">                 </span><span class="o">[</span><span class="m">2</span>,<span class="w"> </span><span class="m">3</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">5</span><span class="o">]</span>
C<span class="w"> </span><span class="m">0</span>.94<span class="w"> </span><span class="m">0</span>.02<span class="w"> </span>-0.09
O<span class="w"> </span><span class="m">0</span>.47<span class="w"> </span><span class="m">0</span>.27<span class="w"> </span>-1.4
-----<span class="w">  </span>ml.read_mol<span class="w"> </span>::<span class="w"> </span>parse<span class="w"> </span>results...<span class="w"> </span>-------
representative_atom_index<span class="w">  </span>::<span class="w"> </span><span class="m">1</span>
-----------------------------------------------
<span class="o">================</span>
coh_index/coc_index<span class="w"> </span>::<span class="w"> </span><span class="o">[</span>oの番号,<span class="w"> </span><span class="o">{</span>coボンドの番号<span class="o">(</span>co_bond_indexの0から数えていくつか<span class="o">)</span>,ohボンドの番号<span class="o">}]</span>
TODO<span class="w"> </span>::<span class="w"> </span>もしかしたらbond_indexを使った方が全体的にやりやすいかもしれない
coh_index<span class="w"> </span>::<span class="w"> </span><span class="o">[[</span><span class="m">0</span>,<span class="w"> </span><span class="o">{</span><span class="s1">&#39;CO&#39;</span>:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="s1">&#39;OH&#39;</span>:<span class="w"> </span><span class="m">0</span><span class="o">}]]</span>
coc_index<span class="w"> </span>::<span class="w"> </span><span class="o">[]</span>
Loading<span class="w"> </span>xyz<span class="w"> </span>file<span class="w"> </span>::<span class="w">  </span><span class="o">[</span><span class="s1">&#39;IONS+CENTERS+cell_sorted_merge.xyz&#39;</span><span class="o">]</span>
len<span class="w"> </span><span class="nv">xyz</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span>
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:34,561<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w">  </span>-----------------------------------------------------------------
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:34,561<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w">  </span>---Summary<span class="w"> </span>of<span class="w"> </span>DataSystem:<span class="w"> </span>training<span class="w">     </span>----------------------------------
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:34,561<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>found<span class="w"> </span><span class="m">1</span><span class="w"> </span>system<span class="o">(</span>s<span class="o">)</span>:
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:34,561<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w">                         </span>system<span class="w">  </span>natoms<span class="w">  </span>bch_sz<span class="w">   </span>n_bch
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:34,561<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>IONS+CENTERS+cell_sorted_merge.xyz<span class="w">    </span><span class="m">1000</span><span class="w">      </span><span class="m">32</span><span class="w">      </span><span class="m">31</span>
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:21:34,562<span class="w"> </span>root<span class="w"> </span>mltrain<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>--------------------------------------------------------------------------------------
splitting<span class="w"> </span>atoms<span class="w"> </span>into<span class="w"> </span>atoms<span class="w"> </span>and<span class="w"> </span>WCs
Assigning<span class="w"> </span>Wannier<span class="w"> </span>Centers
Finish<span class="w"> </span>Assigning<span class="w"> </span>Wannier<span class="w"> </span>Centers
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:22:28,891<span class="w"> </span>Trainer<span class="w"> </span>__init__<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>model<span class="w"> </span>data<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span><span class="nv">model_test</span>
<span class="o">=================================================================</span>
Layer<span class="w"> </span><span class="o">(</span>type:depth-idx<span class="o">)</span><span class="w">                   </span>Param<span class="w"> </span><span class="c1">#</span>
<span class="o">=================================================================</span>
NET_withoutBN<span class="w">                            </span>--
├─Linear:<span class="w"> </span><span class="m">1</span>-1<span class="w">                            </span><span class="m">3</span>,650
├─Linear:<span class="w"> </span><span class="m">1</span>-2<span class="w">                            </span><span class="m">2</span>,550
├─Linear:<span class="w"> </span><span class="m">1</span>-3<span class="w">                            </span><span class="m">73</span>,440
├─Linear:<span class="w"> </span><span class="m">1</span>-4<span class="w">                            </span><span class="m">6</span>,050
├─Linear:<span class="w"> </span><span class="m">1</span>-5<span class="w">                            </span><span class="m">2</span>,550
├─Linear:<span class="w"> </span><span class="m">1</span>-6<span class="w">                            </span><span class="m">1</span>,020
<span class="o">=================================================================</span>
Total<span class="w"> </span>params:<span class="w"> </span><span class="m">89</span>,260
Trainable<span class="w"> </span>params:<span class="w"> </span><span class="m">89</span>,260
Non-trainable<span class="w"> </span>params:<span class="w"> </span><span class="nv">0</span>
<span class="o">=================================================================</span>

<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:22:28,892<span class="w"> </span>Trainer<span class="w"> </span>init_model<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>Torch<span class="w"> </span>device<span class="w"> </span><span class="o">(</span>cpu<span class="w"> </span>or<span class="w"> </span>cuda<span class="w"> </span>gpu<span class="w"> </span>or<span class="w"> </span>m1<span class="w"> </span>mac<span class="w"> </span>gpu<span class="o">)</span>:<span class="w"> </span>cpu
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:22:29,384<span class="w"> </span>numexpr.utils<span class="w"> </span>_init_num_threads<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>Note:<span class="w"> </span>NumExpr<span class="w"> </span>detected<span class="w"> </span><span class="m">16</span><span class="w"> </span>cores<span class="w"> </span>but<span class="w"> </span><span class="s2">&quot;NUMEXPR_MAX_THREADS&quot;</span><span class="w"> </span>not<span class="w"> </span>set,<span class="w"> </span>so<span class="w"> </span>enforcing<span class="w"> </span>safe<span class="w"> </span>limit<span class="w"> </span>of<span class="w"> </span><span class="m">8</span>.
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:22:29,384<span class="w"> </span>numexpr.utils<span class="w"> </span>_init_num_threads<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span>NumExpr<span class="w"> </span>defaulting<span class="w"> </span>to<span class="w"> </span><span class="m">8</span><span class="w"> </span>threads.
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:22:29,556<span class="w"> </span>Trainer<span class="w"> </span>set_dataset<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w">  </span>n_traing<span class="w"> </span><span class="o">(</span><span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>training<span class="w">  </span>data<span class="o">)</span>:<span class="w"> </span><span class="m">900</span>
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:22:29,556<span class="w"> </span>Trainer<span class="w"> </span>set_dataset<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w">  </span>n_val<span class="w">    </span><span class="o">(</span><span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>validatin<span class="w"> </span>data<span class="o">)</span>:<span class="w"> </span><span class="m">100</span>
^@2024-05-27<span class="w"> </span><span class="m">23</span>:23:05,110<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">35</span>.553799867630005<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0030520600183600827<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0028606270595143237<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0551564542987999<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.05347409362915805
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp1.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:23:41,283<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">36</span>.05292296409607<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002742534619756043<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002425628947094083<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.05222889056766713<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04924118021059818
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp2.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:24:17,498<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">36</span>.17855882644653<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0027552477217146327<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0023257903133829436<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.05240615377016262<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04821778239842708
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp3.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:24:52,931<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">35</span>.389596939086914<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002701992983929813<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002566932700574398<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.051863416078856424<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0505809825728987
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp4.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:25:28,712<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">35</span>.72677397727966<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0026170784757206483<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0026297084211061397<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.05109348549317842<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.05118794610165333
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp5.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:26:02,858<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">34</span>.10452723503113<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002519122832122126<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002710235926012198<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.05010292158956631<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.05182654546680134
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp6.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:26:36,344<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.43118190765381<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002488897938746959<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002438249376912912<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04980324078916386<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04936132032714493
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp7.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:27:09,524<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.13404870033264<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0024281473555934747<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0024121985770761967<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.049172273966610065<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04911379181779723
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp8.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:27:42,988<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">9</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.424768924713135<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0024187416752933393<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.00232696447831889<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04911207242387859<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04820846097177897
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp9.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:28:17,375<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">34</span>.339770793914795<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.002027994516538456<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0020500118068108955<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.04497044101939407<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.045273193022861896
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp10.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:28:50,388<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">32</span>.96853709220886<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0018060718056014074<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0015387694584205747<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.042402016109021445<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0391866800126098
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp11.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:29:23,494<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.06202292442322<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0015744604378206922<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.001602462415272991<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03961410282709073<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03996957523043282
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp12.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:29:56,833<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">13</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.296122789382935<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0015049170885634208<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0015406373422592878<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03872750117829672<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.039230152528586505
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp13.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:30:30,009<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.13048601150513<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0014625149363252734<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0013872180522109072<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.038211363274244604<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03717074105946483
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp14.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:31:03,023<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">32</span>.970470905303955<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012952481338288635<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011708201685299475<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03594431862161766<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.034191540839132055
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp15.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:31:37,101<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">34</span>.034749031066895<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012781490970935141<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012487516505643725<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03567568660112371<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03530874235402812
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp16.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:32:10,323<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">17</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.178393840789795<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012396411870473198<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012016038332755368<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0351610294889353<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0346635038703976
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp17.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:32:43,535<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.16394877433777<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012235958503359662<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012918139109387994<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03492190754501672<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03592647573961546
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp18.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:33:16,961<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.37561392784119<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012278797990542703<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012458103786533077<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03499613492118348<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.035192720360356027
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp19.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:33:50,577<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.57127404212952<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012240493794836635<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.001295727367202441<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03495633493656875<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03591999197134574
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp20.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:34:23,622<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">21</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">32</span>.997060775756836<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012256120015600963<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011909629683941603<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03495001219865892<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03448448842303
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp21.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:34:56,853<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">22</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.18896174430847<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012167344518404985<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012835346860811114<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.034833311084896894<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03577993540008407
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp22.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:35:29,807<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">23</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">32</span>.91186189651489<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011236058489885181<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011108355053390067<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03343205283435263<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03328191643945063
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp23.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:36:03,022<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">24</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.170867919921875<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.001198199895692856<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011316734598949552<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03454902092721321<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03361872941420203
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp24.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:36:36,357<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">25</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.290594816207886<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011569774401972868<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.00125562238584583<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03398148767577144<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03526287444169499
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp25.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:37:09,678<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">26</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.2756552696228<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0010826434694796003<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012303667608648539<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03285225680652831<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0350027180085837
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp26.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:37:43,053<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">27</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">33</span>.32958698272705<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.001173686479367981<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0010828875432101388<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.034169700120643916<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03287867522535803
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp27.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:38:19,747<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">28</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">36</span>.647231101989746<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.001116036980030393<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012196329965566595<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03330824263660591<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03489144527681723
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp28.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:38:59,670<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">29</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">39</span>.88249492645264<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011180073737965099<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0012258108084400494<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03336500989034002<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03500258438073604
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp29.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:39:49,398<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">49</span>.675516843795776<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0010629503813106567<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0010745280305854976<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03253391709756107<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03270917398237465
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp30.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:40:26,195<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">31</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">36</span>.73529386520386<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0010963863585077757<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.001109493294886003<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03305228076125506<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03320700290457949
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp31.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:41:06,045<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">32</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">39</span>.80792784690857<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.001064531773278889<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0011376045683088403<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.032547290130018745<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03362633110102043
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp32.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:41:46,186<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">33</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">40</span>.091362953186035<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0010355500500216813<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0009315957043630382<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.03212837784581807<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.030487922940679202
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp33.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:42:21,759<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">34</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">35</span>.53277611732483<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0009523128766366946<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008897289323310057<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.030749915142596514<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.029788555875735753
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp34.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:42:57,443<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">35</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">35</span>.59277606010437<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0009194710645325748<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008036431002741059<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.030231966427741203<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.028328095215842314
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp35.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:43:34,729<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">36</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">37</span>.2429301738739<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008694644493516535<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008589115265446404<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.02939380869049454<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.029268487767904347
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp36.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:44:10,015<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">37</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">35</span>.23839807510376<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008100573946389236<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0007349376101046801<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.02839690322675918<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0270813759830895
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp37.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:44:46,935<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">38</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">36</span>.876343965530396<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008246830173967672<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0007781900543098649<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.028661926251427983<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.027891913603732336
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp38.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:45:27,108<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">39</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">40</span>.12124514579773<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008413328593763124<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008210245287045836<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.028899934585797222<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.02863102027700547
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp39.pt<span class="w"> </span>at<span class="w"> </span>model_test
<span class="m">2024</span>-05-27<span class="w"> </span><span class="m">23</span>:46:17,073<span class="w"> </span>Trainer<span class="w"> </span>epoch_step<span class="w"> </span><span class="o">[</span>INFO<span class="o">]</span>:<span class="w"> </span><span class="nv">epoch</span><span class="o">=</span><span class="w"> </span><span class="m">40</span><span class="w"> </span>:<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="w"> </span><span class="m">49</span>.92154312133789<span class="w"> </span><span class="o">[</span>s<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008217944268835708<span class="w"> </span>:<span class="w"> </span>loss<span class="o">(</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.0008133725496008992<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>train<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.028557669288744897<span class="w"> </span>:<span class="w"> </span>RMSE<span class="o">[</span>D<span class="o">](</span>valid<span class="o">)=</span><span class="w"> </span><span class="m">0</span>.028495248694122847
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_tmp40.pt<span class="w"> </span>at<span class="w"> </span>model_test
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_weight.pth<span class="w"> </span>at<span class="w"> </span>model_test
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test_all.pth<span class="w"> </span>at<span class="w"> </span>model_test
model<span class="w"> </span>is<span class="w"> </span>saved<span class="w"> </span>to<span class="w"> </span>model_test.pt<span class="w"> </span>at<span class="w"> </span>model_test
</pre></div>
</div>
<p>To train models for all the chemical bond species, We iteratively run the command with modifying the input of <code class="docutils literal notranslate"><span class="pre">bondtype</span></code>.</p>
</section>
<section id="test-a-model">
<h3>Test a model<a class="headerlink" href="#test-a-model" title="Link to this heading"></a></h3>
<p>We can check the quality of the trained model using a <cite>yaml</cite> structure file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CPtrain.py<span class="w"> </span><span class="nb">test</span><span class="w"> </span>-m<span class="w"> </span>chmodel_test/model_ch_python.pt<span class="w"> </span>-x<span class="w"> </span>IONS+CENTERS+cell_sorted_merge.xyz<span class="w"> </span>-m<span class="w"> </span>methanol.mol
</pre></div>
</div>
<p>It takes a few minutes to complete the calculation. The code generates two figures and two text files. The figures are the correlation between the predicted and true dipole moments (and the absolute value of the dipole moment). The text files named <code class="docutils literal notranslate"><span class="pre">pred_list.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">true_list.txt</span></code> contain the predicted dipole moments and the true dipole moments, and they are visualized in <code class="docutils literal notranslate"><span class="pre">pred_true_norm.png</span></code> and <code class="docutils literal notranslate"><span class="pre">pred_true_density.png</span></code>.</p>
<a class="reference internal image-reference" href="_images/pred_true_norm.png"><img alt="_images/pred_true_norm.png" class="align-center" src="_images/pred_true_norm.png" style="width: 400px;" /></a>
</section>
</section>
<section id="calculate-dipoles-along-md-trajectories">
<h2>Calculate dipoles along MD trajectories<a class="headerlink" href="#calculate-dipoles-along-md-trajectories" title="Link to this heading"></a></h2>
<p>After constructing four dipole moment models (<code class="docutils literal notranslate"><span class="pre">CH</span></code>, <code class="docutils literal notranslate"><span class="pre">CO</span></code>, <code class="docutils literal notranslate"><span class="pre">OH</span></code>, and <code class="docutils literal notranslate"><span class="pre">O</span></code>) and validating our trained model works well, we try our model on molecular dynamics trajectories using C++ interface. Let us go to the example directory</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>examples/dieltools/methanol
</pre></div>
</div>
<p>The input file for the C++ code is given in <code class="docutils literal notranslate"><span class="pre">yaml</span></code> format and is as follows.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>general:
<span class="w">    </span>itpfilename:<span class="w"> </span>methanol.acpype/input_GMX.mol
<span class="w">    </span>bondfilename:<span class="w"> </span>methanol.mol
<span class="w">    </span>savedir:<span class="w"> </span>dipole_10ps/
<span class="w">    </span>temperature:<span class="w"> </span><span class="m">300</span>
<span class="w">    </span>timestep:<span class="w"> </span><span class="m">0</span>.242
descriptor:
<span class="w">    </span>calc:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>directory:<span class="w"> </span>./
<span class="w">    </span>xyzfilename:<span class="w"> </span>IONS+CENTERS+cell_sorted_merge.xyz
<span class="w">    </span>savedir:<span class="w"> </span>dipole_10ps/
<span class="w">    </span>descmode:<span class="w"> </span><span class="m">2</span>
<span class="w">    </span>desctype:<span class="w"> </span>allinone
<span class="w">    </span>haswannier:<span class="w"> </span><span class="m">1</span><span class="w">   </span><span class="c1"># if WCs are in xyz, set 1</span>
<span class="w">    </span>interval:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>desc_coh:<span class="w"> </span><span class="m">0</span>
predict:
<span class="w">    </span>calc:<span class="w"> </span><span class="m">1</span>
<span class="w">    </span>desc_dir:<span class="w"> </span>dipole_10ps/
<span class="w">    </span>model_dir:<span class="w"> </span>model_rotate_methanol/
<span class="w">    </span>modelmode:<span class="w"> </span>rotate
<span class="w">    </span>bondspecies:<span class="w"> </span><span class="m">4</span>
<span class="w">    </span>save_truey:<span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<p>The input composes of three part, <code class="docutils literal notranslate"><span class="pre">general</span></code>, <code class="docutils literal notranslate"><span class="pre">descripter</span></code>, and <code class="docutils literal notranslate"><span class="pre">predict</span></code>. The details of the parameters are given bellow.</p>
<ul>
<li><p>general</p>
<blockquote>
<div><ul class="simple">
<li><p>itpfilename[required]: <code class="docutils literal notranslate"><span class="pre">mol</span></code> file for the molecule. (methanol in our case)</p></li>
<li><p>savedir[required]:     The directory to which all the outputs will be saved.</p></li>
<li><p>temperature[optional]: We can optionally set the temperature to calculate dielectric properties. The default is 300 [Kelvin]</p></li>
<li><p>timestep[optional]:    We can optionally set the MD timestep to calculate dynamical dielectric properties.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>descripter</p>
<blockquote>
<div><ul class="simple">
<li><p>calc[required]: 1 for doing calculation, 0 for skip calculation.</p></li>
<li><p>directory[required]: The directory in which the input xyz is stored.</p></li>
<li><p>xyzfilename[required]: The input xyz filename.</p></li>
<li><p>desctype[required]: The type of descriptor. Currently we have <code class="docutils literal notranslate"><span class="pre">allinone</span></code> and <code class="docutils literal notranslate"><span class="pre">old</span></code>.</p></li>
</ul>
</div></blockquote>
</li>
<li><dl class="simple">
<dt>predict:</dt><dd><ul class="simple">
<li><p>calc: 1</p></li>
<li><p>desc_dir: dipole_10ps/</p></li>
<li><p>model_dir: /home/k0151/k015124/c++/20231025_model_rotate_methanol/</p></li>
<li><p>modelmode: rotate</p></li>
<li><p>bondspecies: 4</p></li>
<li><p>save_truey: 0</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>You can perform C++ calculations with enabling OpenMP. For example, you can set the number of threads to 12 by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span><span class="m">12</span>
dieltools<span class="w"> </span>config.yaml
</pre></div>
</div>
<p>After the calculation, the following result files are saved in the directory specified by <code class="docutils literal notranslate"><span class="pre">savedir</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_dipole.txt</span></code>: system total dipole.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mol_wan.xyz</span></code>: atomic and predicted WCs configurations in <code class="docutils literal notranslate"><span class="pre">xyz</span></code> format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DIELCONST</span></code>: dielectric constant and average molecular dipole.</p></li>
</ul>
<p>We can visualize the system dipole moment along the MD trajectory using <code class="docutils literal notranslate"><span class="pre">total_dipole.txt</span></code> to see if our calculation success.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CPextract</span><span class="o">.</span><span class="n">py</span> <span class="n">diel</span> <span class="n">total</span> <span class="o">-</span><span class="n">F</span> <span class="n">dipole_10ps</span><span class="o">/</span><span class="n">total_dipole</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/total_dipole.txt_time_dipole.png"><img alt="_images/total_dipole.txt_time_dipole.png" class="align-center" src="_images/total_dipole.txt_time_dipole.png" style="width: 400px;" /></a>
<p>Finally, we perform Fourier transformation of the total dipole moments to calculate the dielectric function via <code class="docutils literal notranslate"><span class="pre">CPextract.py</span></code> command. You must specify the high-frequency dielectric constant with <code class="docutils literal notranslate"><span class="pre">-E</span></code> option</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>CPextract.py<span class="w"> </span>diel<span class="w"> </span>spectra<span class="w"> </span>-F<span class="w"> </span>total_dipole.txt<span class="w"> </span>-E<span class="w"> </span><span class="m">1</span>.76624<span class="w"> </span>-s<span class="w"> </span><span class="m">0</span><span class="w"> </span>-w<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>The above command generate three files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total_dipole.txt_diel.csv</span></code>: real and imaginary parts of the dielectric function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_dipole.txt_refractive.csv</span></code>: real and imaginary parts of the complex refractive index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_dipole.txt_alphan.csv</span></code>: absorption spectra <code class="docutils literal notranslate"><span class="pre">alpha(\omega)*n(\omega)</span></code>.</p></li>
</ul>
<p>Here we visualize the imaginary part of the dielectric function using the following python script.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># load data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;dipole_10ps/total_dipole.txt_diel.csv&quot;</span><span class="p">)</span>

<span class="c1"># figure instantce</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;freq_kayser&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;imag_diel&quot;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;imag_diel&quot;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3500</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">xticklabels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span>
<span class="n">yticklabels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()</span>
<span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Frequency [cm-1]&quot;</span>
<span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Epsilon&quot;</span>

<span class="c1">#</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span> <span class="p">)</span>
<span class="n">lgnd</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># lgnd.legendHandles[0]._sizes = [30]</span>
<span class="c1"># lgnd.legendHandles[0]._alpha = [1.0]</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;imag_diel.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/imag_diel.png"><img alt="_images/imag_diel.png" class="align-center" src="_images/imag_diel.png" style="width: 400px;" /></a>
<p>As the MD trajectory is too short, we can not get meaningful spectra. We will acquire better one in the following tutorials.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="install/installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="getting-started_2.html" class="btn btn-neutral float-right" title="Getting-started tutorial No. 2: Isolated methanol" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Tomohito Amano, Tamio Yamazaki.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>