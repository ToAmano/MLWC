2025-03-02 03:14:27 PM - MLWC - INFO -  
2025-03-02 03:14:27 PM - MLWC - INFO -  *****************************************************************
2025-03-02 03:14:27 PM - MLWC - INFO -                        CPtrain.py                                 
2025-03-02 03:14:27 PM - MLWC - INFO -                        Version. 0.2.0         
2025-03-02 03:14:27 PM - MLWC - INFO -  *****************************************************************
2025-03-02 03:14:27 PM - MLWC - INFO -  
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -------------------------------------- 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  ================ 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  CH bonds...        [[0, 4], [0, 2], [0, 3]]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  CO bonds...        [[1, 0]]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  OH bonds...        [[5, 1]]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  OO bonds...        []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  CC bonds...        []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  CO double bonds... []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  ================== 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  ch_bond_index        :: [0, 1, 2]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  oh_bond_index        :: [4]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  co_bond_index        :: [3]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  cc_bond_index        :: []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  cc_double_bond_index :: []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  ===========  _get_atomic_index ========== 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  O atoms (lonepair)...      [1]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  N atoms (lonepair)...      []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  C atoms ...                [0]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  H atoms ...                [2, 3, 4, 5]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  S atoms ...                []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  F atoms ...                []
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  ========================================= 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  ================ 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -   Atomic coordinates 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  C 0.94 0.02 -0.09
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  O 0.47 0.27 -1.4
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  -----  ml.read_mol :: parse results... -------
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  bonds_list ::  [[0, 4], [0, 2], [0, 3], [1, 0], [5, 1]]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  num atoms per mol  :: 6
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  atom_list  :: ['C', 'O', 'H', 'H', 'H', 'H']
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  bonds_type :: [1, 1, 1, 1, 1]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  representative_atom_index  :: 1
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  -----------------------------------------------
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  ================ 
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  coh_index/coc_index :: [o indx(in O atoms only), o indx(atomic index), {co bond indx(count in co_bond_index from 0),oh bond indx}]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  coh_index :: [[0, 1, {'CO': 0, 'OH': 0}]]
2025-03-02 03:14:27 PM - MLWC.ml.atomtype - INFO -  coc_index :: []
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  The number of atoms in a single molecule :: 6
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  Loading xyz file :: ['IONS+CENTERS+cell_sorted_merge.xyz']
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  Finish loading xyz file...
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  The number of trajectories are 1
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO - 
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  ----------------------------------------------------------------------- 
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -----------  Summary of training Data --------------------------------- 
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO - found 1 system(s):
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -                                     system  nun_frames  batch_size  num_batch natoms(include WC)
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO - IONS+CENTERS+cell_sorted_merge.xyz    1000      32      31    416
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO - --------------------------------------------------------------------------------------
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  splitting atoms into atoms and WCs
2025-03-02 03:14:27 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  Assigning Wannier Centers
2025-03-02 03:14:51 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  Finish Assigning Wannier Centers
2025-03-02 03:14:52 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -----------  Summary of dataset ------------ 
2025-03-02 03:14:52 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   bond_name         :: CH
2025-03-02 03:14:52 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   calculate_bond    :: [0, 1, 2]
2025-03-02 03:14:52 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   bondtype          :: bond
2025-03-02 03:14:52 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   dataset_function  :: ConcreteFactory_xyz
2025-03-02 03:14:52 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -------------------------------------------- 
2025-03-02 03:14:52 PM - MLWC.Trainer - INFO - model data will be saved to model_ch
2025-03-02 03:14:52 PM - MLWC.ml.ml_train - INFO - =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
NET_withoutBN                            --
├─Sequential: 1-1                        --
│    └─Linear: 2-1                       3,650
│    └─LeakyReLU: 2-2                    --
│    └─Linear: 2-3                       2,550
│    └─LeakyReLU: 2-4                    --
│    └─Linear: 2-5                       73,440
├─Sequential: 1-2                        --
│    └─Linear: 2-6                       6,050
│    └─LeakyReLU: 2-7                    --
│    └─Linear: 2-8                       2,550
│    └─LeakyReLU: 2-9                    --
│    └─Linear: 2-10                      1,020
=================================================================
Total params: 89,260
Trainable params: 89,260
Non-trainable params: 0
=================================================================
2025-03-02 03:14:52 PM - MLWC.Trainer - INFO - Torch device (cpu or cuda gpu or m1 mac gpu): cpu
2025-03-02 03:14:53 PM - MLWC.Trainer - INFO -  n_traing ( number of training  data): 900
2025-03-02 03:14:53 PM - MLWC.Trainer - INFO -  n_val    ( number of validatin data): 100
2025-03-02 03:15:06 PM - MLWC.Trainer - INFO - epoch= 1 : time= 12.07 [s] : lr= 0.010000 : loss(train)= 0.00330 : loss(valid)= 0.00306 : RMSE[D](train)= 0.05731 : RMSE[D](valid)= 0.05521
2025-03-02 03:15:18 PM - MLWC.Trainer - INFO - epoch= 2 : time= 12.06 [s] : lr= 0.009500 : loss(train)= 0.00255 : loss(valid)= 0.00232 : RMSE[D](train)= 0.05038 : RMSE[D](valid)= 0.04810
2025-03-02 03:15:30 PM - MLWC.Trainer - INFO - epoch= 3 : time= 12.17 [s] : lr= 0.009025 : loss(train)= 0.00158 : loss(valid)= 0.00137 : RMSE[D](train)= 0.03964 : RMSE[D](valid)= 0.03701
2025-03-02 03:15:43 PM - MLWC.Trainer - INFO - epoch= 4 : time= 12.34 [s] : lr= 0.008574 : loss(train)= 0.00165 : loss(valid)= 0.00171 : RMSE[D](train)= 0.04049 : RMSE[D](valid)= 0.04140
2025-03-02 03:15:55 PM - MLWC.Trainer - INFO - epoch= 5 : time= 12.40 [s] : lr= 0.008145 : loss(train)= 0.00137 : loss(valid)= 0.00137 : RMSE[D](train)= 0.03701 : RMSE[D](valid)= 0.03702
2025-03-02 03:15:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -----------  Summary of dataset ------------ 
2025-03-02 03:15:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   bond_name         :: OH
2025-03-02 03:15:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   calculate_bond    :: [4]
2025-03-02 03:15:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   bondtype          :: bond
2025-03-02 03:15:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   dataset_function  :: ConcreteFactory_xyz
2025-03-02 03:15:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -------------------------------------------- 
2025-03-02 03:15:55 PM - MLWC.Trainer - INFO - model data will be saved to model_oh
2025-03-02 03:15:55 PM - MLWC.ml.ml_train - INFO - =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
NET_withoutBN                            --
├─Sequential: 1-1                        --
│    └─Linear: 2-1                       3,650
│    └─LeakyReLU: 2-2                    --
│    └─Linear: 2-3                       2,550
│    └─LeakyReLU: 2-4                    --
│    └─Linear: 2-5                       73,440
├─Sequential: 1-2                        --
│    └─Linear: 2-6                       6,050
│    └─LeakyReLU: 2-7                    --
│    └─Linear: 2-8                       2,550
│    └─LeakyReLU: 2-9                    --
│    └─Linear: 2-10                      1,020
=================================================================
Total params: 89,260
Trainable params: 89,260
Non-trainable params: 0
=================================================================
2025-03-02 03:15:55 PM - MLWC.Trainer - INFO - Torch device (cpu or cuda gpu or m1 mac gpu): cpu
2025-03-02 03:15:55 PM - MLWC.Trainer - INFO -  n_traing ( number of training  data): 900
2025-03-02 03:15:55 PM - MLWC.Trainer - INFO -  n_val    ( number of validatin data): 100
2025-03-02 03:16:08 PM - MLWC.Trainer - INFO - epoch= 1 : time= 11.70 [s] : lr= 0.010000 : loss(train)= 0.00227 : loss(valid)= 0.00245 : RMSE[D](train)= 0.04726 : RMSE[D](valid)= 0.04945
2025-03-02 03:16:20 PM - MLWC.Trainer - INFO - epoch= 2 : time= 11.70 [s] : lr= 0.009500 : loss(train)= 29.56532 : loss(valid)= 42.52967 : RMSE[D](train)= 5.36464 : RMSE[D](valid)= 6.39674
2025-03-02 03:16:31 PM - MLWC.Trainer - INFO - epoch= 3 : time= 11.73 [s] : lr= 0.009025 : loss(train)= 17.03551 : loss(valid)= 26.22850 : RMSE[D](train)= 4.08044 : RMSE[D](valid)= 5.07455
2025-03-02 03:16:43 PM - MLWC.Trainer - INFO - epoch= 4 : time= 12.04 [s] : lr= 0.008574 : loss(train)= 23.54178 : loss(valid)= 21.18813 : RMSE[D](train)= 4.45520 : RMSE[D](valid)= 4.56424
2025-03-02 03:16:55 PM - MLWC.Trainer - INFO - epoch= 5 : time= 11.63 [s] : lr= 0.008145 : loss(train)= 10.77502 : loss(valid)= 14.73437 : RMSE[D](train)= 3.23680 : RMSE[D](valid)= 3.82764
2025-03-02 03:16:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -----------  Summary of dataset ------------ 
2025-03-02 03:16:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   bond_name         :: O
2025-03-02 03:16:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   calculate_bond    :: [1]
2025-03-02 03:16:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   bondtype          :: lonepair
2025-03-02 03:16:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -   dataset_function  :: ConcreteFactory_xyz
2025-03-02 03:16:55 PM - MLWC.cmdline.cptrain_train.cptrain_train - INFO -  -------------------------------------------- 
2025-03-02 03:16:55 PM - MLWC.Trainer - INFO - model data will be saved to model_o
2025-03-02 03:16:55 PM - MLWC.ml.ml_train - INFO - =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
NET_withoutBN                            --
├─Sequential: 1-1                        --
│    └─Linear: 2-1                       3,650
│    └─LeakyReLU: 2-2                    --
│    └─Linear: 2-3                       2,550
│    └─LeakyReLU: 2-4                    --
│    └─Linear: 2-5                       73,440
├─Sequential: 1-2                        --
│    └─Linear: 2-6                       6,050
│    └─LeakyReLU: 2-7                    --
│    └─Linear: 2-8                       2,550
│    └─LeakyReLU: 2-9                    --
│    └─Linear: 2-10                      1,020
=================================================================
Total params: 89,260
Trainable params: 89,260
Non-trainable params: 0
=================================================================
2025-03-02 03:16:55 PM - MLWC.Trainer - INFO - Torch device (cpu or cuda gpu or m1 mac gpu): cpu
2025-03-02 03:16:55 PM - MLWC.Trainer - INFO -  n_traing ( number of training  data): 900
2025-03-02 03:16:55 PM - MLWC.Trainer - INFO -  n_val    ( number of validatin data): 100
2025-03-02 03:17:09 PM - MLWC.Trainer - INFO - epoch= 1 : time= 13.07 [s] : lr= 0.010000 : loss(train)= 0.01527 : loss(valid)= 0.01301 : RMSE[D](train)= 0.12321 : RMSE[D](valid)= 0.11387
2025-03-02 03:17:22 PM - MLWC.Trainer - INFO - epoch= 2 : time= 12.84 [s] : lr= 0.009500 : loss(train)= 0.00951 : loss(valid)= 0.00868 : RMSE[D](train)= 0.09717 : RMSE[D](valid)= 0.09308
2025-03-02 03:17:35 PM - MLWC.Trainer - INFO - epoch= 3 : time= 12.73 [s] : lr= 0.009025 : loss(train)= 0.00844 : loss(valid)= 0.00905 : RMSE[D](train)= 0.09151 : RMSE[D](valid)= 0.09502
2025-03-02 03:17:48 PM - MLWC.Trainer - INFO - epoch= 4 : time= 12.68 [s] : lr= 0.008574 : loss(train)= 0.00915 : loss(valid)= 0.00752 : RMSE[D](train)= 0.09491 : RMSE[D](valid)= 0.08626
2025-03-02 03:18:00 PM - MLWC.Trainer - INFO - epoch= 5 : time= 12.64 [s] : lr= 0.008145 : loss(train)= 0.00733 : loss(valid)= 0.00728 : RMSE[D](train)= 0.08525 : RMSE[D](valid)= 0.08506
